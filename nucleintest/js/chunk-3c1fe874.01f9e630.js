(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c1fe874"],{"0675":function(e,t,i){e.exports=i.p+"img/已签核.857463ea.svg"},1533:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("van-nav-bar",{staticClass:"title-style",staticStyle:{"background-color":"#5d8eec"},attrs:{title:e.titleText,"left-text":e.backText,"right-text":e.$store.state.rightText,"left-arrow":e.isShowBack,fixed:""},on:{"click-left":e.onClickLeft,"click-right":e.onClickRight}}),e.isShowEnclosure?e._e():i("div",{staticClass:"container"},[i("span",{directives:[{name:"show",rawName:"v-show",value:e.applyState,expression:"applyState"}],staticClass:"apply-title"},[e._v(e._s(e.applyState))]),i("van-form",{ref:"form",staticClass:"form-wrap",staticStyle:{"margin-bottom":"50Px"},on:{submit:e.onSubmit}},[e._l(e.formDate,(function(t,a){return i("van-cell-group",{key:a},[i("van-field",{attrs:{name:t.name,label:t.label,placeholder:t.label,"right-icon":t.rightIcon,readonly:!(!t.rightIcon&&!t.pickerDate),disabled:e.isCommited||t.isCommited,rules:t.rules},on:{focus:function(i){(t.rightIcon||t.pickerDate)&&e.selectValue(t)}},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1)})),i("van-cell-group",[i("van-cell",{attrs:{center:"",title:"缓冲宿舍区"}},[i("van-switch",{attrs:{slot:"right-icon",size:"24",disabled:e.isCommited},slot:"right-icon",model:{value:e.bufferDorm,callback:function(t){e.bufferDorm=t},expression:"bufferDorm"}})],1)],1),i("van-cell-group",[i("van-cell",{attrs:{center:"",title:"外住"}},[i("van-switch",{attrs:{slot:"right-icon",size:"24",disabled:e.isCommited},slot:"right-icon",model:{value:e.livingOutside,callback:function(t){e.livingOutside=t},expression:"livingOutside"}})],1)],1),i("van-cell-group",[i("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",label:"留言",maxlength:"50",placeholder:"请输入留言","show-word-limit":"",name:e.messageName,disabled:e.isCommited},model:{value:e.leavingMessage,callback:function(t){e.leavingMessage=t},expression:"leavingMessage"}})],1),i("uploader-model",{directives:[{name:"show",rawName:"v-show",value:!e.isShowStep,expression:"!isShowStep"}],attrs:{fileList:e.fileList},on:{clearFile:e.clearFile}}),e.isShowStep?i("van-cell",{attrs:{title:"附件","is-link":""},on:{click:e.navToFileList}}):e._e(),i("van-steps",{directives:[{name:"show",rawName:"v-show",value:e.isShowStep,expression:"isShowStep"}],staticStyle:{"padding-bottom":"40px"},attrs:{direction:"vertical","inactive-icon":e.yqh,"active-icon":e.activeIcon,active:e.signatureList.length-1}},e._l(e.signatureList,(function(t,a){return i("van-step",{directives:[{name:"show",rawName:"v-show",value:t["signatureStatus"],expression:"signature['signatureStatus']"}],key:a},[i("h3",{staticClass:"step-title"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.signTime,expression:"signature.signTime"}]},[e._v(e._s(t.signTime))]),e._v(" "),i("span",[e._v(e._s(t.name))])]),i("p",{directives:[{name:"show",rawName:"v-show",value:t.comment,expression:"signature.comment"}],staticClass:"step-des"},[e._v(e._s(t.comment))])])})),1)],2),i("van-action-sheet",{attrs:{actions:e.sheetaActions},on:{select:e.onSelectSheet},model:{value:e.isShowSheet,callback:function(t){e.isShowSheet=t},expression:"isShowSheet"}}),i("van-calendar",{attrs:{"min-date":e.minDate,"default-date":e.currentDate},on:{confirm:e.onConfirmDate},model:{value:e.isShowDatePicker,callback:function(t){e.isShowDatePicker=t},expression:"isShowDatePicker"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowBottom,expression:"isShowBottom"}],staticClass:"bottom-button"},[i("van-button",{attrs:{type:"default"},on:{click:function(t){e.isShowAdvice=!0,e.signatureButton=2}}},[e._v("拒绝")]),i("van-button",{attrs:{type:"primary"},on:{click:function(t){e.isShowAdvice=!0,e.signatureButton=1}}},[e._v("通过审核")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowConfirmButton,expression:"isShowConfirmButton"}],staticClass:"confirm-completion"},[i("van-button",{attrs:{type:"primary",disabled:e.forbidden},on:{click:e.confirmOrder}},[e._v("确认已完成核酸检测")])],1),i("van-dialog",{staticClass:"show-advice",attrs:{title:"请输入审批意见","show-cancel-button":""},on:{cancel:function(t){e.isShowAdvice=!1},confirm:function(t){return e.signature(e.signatureButton)}},model:{value:e.isShowAdvice,callback:function(t){e.isShowAdvice=t},expression:"isShowAdvice"}},[i("van-field",{attrs:{rows:"4",autosize:"",type:"textarea",maxlength:"50",placeholder:"请输入审核意见","show-word-limit":""},model:{value:e.advices,callback:function(t){e.advices=t},expression:"advices"}})],1)],1),e.isShowEnclosure?i("enclosure",{attrs:{currentUser:e.currentUser}}):e._e()],1)},s=[],n=(i("99af"),i("4de4"),i("4160"),i("13d5"),i("fb6a"),i("a434"),i("b0c0"),i("a9e3"),i("159b"),i("2909")),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"file-list"},[i("van-grid",{attrs:{"column-num":3,square:"",gutter:10}},[e._l(e.fileList,(function(t,a){return i("van-grid-item",{key:a,staticClass:"grid-item"},[i("van-icon",{staticClass:"file-icon",attrs:{size:"35",name:"description"}}),i("van-icon",{staticClass:"clear-file",attrs:{size:"24",name:"close"},on:{click:function(i){return e.send(t.name,t.id)}}}),i("p",{staticClass:"over-auto"},[e._v(e._s(t.name))])],1)})),i("div",{attrs:{id:"picker-file"}},[e._v("上传附件")])],2)],1)},r=[],l={props:{fileList:Array},data:function(){return{}},created:function(){},methods:{send:function(e,t){this.$emit("clearFile",e,t)}}},c=l,u=(i("8294"),i("2877")),d=Object(u["a"])(c,o,r,!1,null,"65bc8fac",null),m=d.exports,h=i("5a8d"),f=i("1c03"),v={name:"Apply",inject:["reload"],components:{UploaderModel:m,enclosure:h["default"]},data:function(){return{isShowEnclosure:!1,currentUser:{localToken:"",appId:""},isShowAdvice:!1,activeIcon:"",isOver:!1,applyState:"您还未申请，请如实填写以下信息",backText:this.$store.state.isOrg?"返回":"",titleText:"核酸检测申请",isShowBack:!!this.$store.state.isOrg,isShowSheet:!1,isShowBottom:!1,sheetaActions:[],isShowStep:!1,activeStep:1,wqh:i("458f"),yqh:i("0675"),jj:i("b99b"),currentItem:"",isShowDatePicker:!1,minDate:new Date(2010,0,1),currentDate:new Date,docType:".png, .jpg, .jpeg,.doc,.docx,.xml",isCommited:!1,isShowConfirmButton:!1,forbidden:!0,isRead:!1,formDate:[{name:"name",label:"用户名",value:"",isCommited:!1,rules:[{required:!0,message:"请正确填写用户名"}]},{name:"staffId",label:"工号",value:"",isCommited:!1,rules:[{required:!0,message:"请正确填写工号"}]},{name:"gender",label:"性别",value:"",id:"",rightIcon:"arrow-down",isCommited:!1,rules:[{required:!0,message:"请正确填写性别"}]},{name:"age",label:"年龄",value:"",isCommited:!1,rules:[{required:!0,message:"请正确填写年龄",validator:this.testAge}]},{name:"group",label:"次集团",value:"",id:"",rightIcon:"arrow-down",rules:[{required:!0,message:"请正确填写次集团"}]},{name:"area",label:"所在厂区",value:"",id:"",rightIcon:"arrow-down",rules:[{required:!0,message:"请正确填写所在厂区"}]},{name:"bu",label:"事业群",value:"",id:"",rightIcon:"arrow-down",rules:[{required:!0,message:"请正确填写事业群"}]},{name:"legelPerson",label:"法人",value:"",id:"",rightIcon:"arrow-down",rules:[{required:!0,message:"请正确填写法人"}]},{name:"costCode",label:"费用代码",value:"",rules:[{required:!0,message:"请正确填写费用代码"}]},{name:"identityCard",label:"身份证号",value:"",isCommited:!1,rules:[{required:!0,message:"请正确填写身份证号码",validator:this.testCardId}]},{name:"phone",label:"联系电话",value:"",isCommited:!1,rules:[{required:!0,message:"请正确填写手机号码",validator:this.testPhone}]},{name:"aTime",label:"到深日期",value:"",pickerDate:!0,rules:[{required:!0,message:"请正确填写到深日期"}]},{name:"isolationDays",label:"隔离天数",value:"",rules:[{required:!0,message:"请正确填写隔离天数"}]}],bufferDorm:!1,advices:"",livingOutside:!1,leavingMessage:"",messageName:"note",fileList:[],myuploader:"",signatureList:[]}},computed:{},watch:{},beforeCreate:function(){},created:function(){var e=sessionStorage.getItem("lastPath");if("/"==e){var t=this.$store.state.userInfo;this.$store.state.isFil?(this.$store.commit("changeRightTitle",""),this.getOrderData(this.$store.state.localToken,""),this.isCommited=!0,this.isShowStep=!0,this.applyState="您已提交申请，请等待审核完成后进行核酸检测",this.currentUser={localToken:this.$store.state.localToken,appId:""}):(this.$store.commit("changeRightTitle","提交"),this.formDate.forEach((function(e){"name"===e.name&&(e.value=t.name),"staffId"===e.name&&(e.value=t.staffId),"phone"===e.name&&(e.value=t.phone),"gender"===e.name&&(e.value=t.SEX,"男"===t.SEX?e.id=1:"女"===t.SEX&&(e.id=0)),"age"===e.name&&(e.value=t.AGE),"identityCard"===e.name&&(e.value=t.IDENTITY_ID||""),e.value&&(e.isCommited=!0)})),this.applyState="您还未申请，请如实填写以下信息")}else"/approval"==e&&(this.isCommited=!0,this.isShowStep=!0,this.getOrderData("",this.$route.query.appId),this.titleText="核酸检测审批",this.currentUser={localToken:"",appId:this.$route.query.appId})},mounted:function(){this.myuploader=WebUploader.create({pick:"#picker-file",mimeTypes:".pdf, .doc, .docx, .xml, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, .png, .jpeg, .jpg",capture:!1});var e=this;this.myuploader.on("fileQueued",(function(t){e.fileList.push(t)}))},destroyed:function(){},methods:{testCardId:function(e){var t=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;return t.test(e)},testPhone:function(e){return/^1[3456789]\d{9}$/.test(e)},testAge:function(e){return/^(?:[1-9][0-9]?|1[01][0-9]|120)$/.test(e)},onSubmit:function(e){var t=this;console.log("submit",e),this.formDate.forEach((function(t){t.id&&(e[t.name]=t.id)}));var i=new FormData,a=this.bufferDorm?1:0,s=this.livingOutside?1:0;for(var n in e["bufferDormitory"]=a,e["outLive"]=s,e["token"]=this.$store.state.localToken,e)i.append(n,e[n]);this.fileList.forEach((function(e,t){i.append("file[]",e.source.source)})),Object(f["a"])(i).then((function(e){t.$store.commit("changeRightTitle",""),t.$store.commit("changeIsFil",1),t.$toast(e.reason),t.reload()}))},selectValue:function(e){var t=this;if(this.currentItem=e,e.pickerDate)this.isShowDatePicker=!0;else if("gender"===e.name)this.sheetaActions=[{name:"男",id:1},{name:"女",id:0}],this.isShowSheet=!0;else{var i={opt:e.name,token:this.$store.state.localToken};Object(f["d"])(i).then((function(e){var i=e.reduce((function(e,t){return[].concat(Object(n["a"])(e),[{name:t.name,id:t.id}])}),[]);t.sheetaActions=i,t.isShowSheet=!0}))}},onSelectSheet:function(e){this.currentItem.value=e.name,this.currentItem.id=e.id,console.log(this.currentItem),this.isShowSheet=!1},onConfirmDate:function(e){this.currentItem.value=this.formatDate(e),this.isShowDatePicker=!1},formatDate:function(e){return"".concat(e.getFullYear(),"/").concat(e.getMonth()+1,"/").concat(e.getDate())},onClickLeft:function(){if(this.isShowEnclosure)this.isShowEnclosure=!1,this.reload();else{if(!this.$store.state.isOrg)return;this.$router.back(-1)}},onClickRight:function(){this.$refs["form"].submit()},getOrderData:function(e,t){var i=this,a={token:e,applicationCode:t};Object(f["e"])(a).then((function(e){i.currentUser.appId=e.appCode,i.formDate.forEach((function(t,i){t.value=e[t.name]})),i.leavingMessage=e["note"],i.bufferDorm=0!=e.bufferDormitory,i.livingOutside=0!=e.outLive,i.signatureList=e.signatureList,i.isShowConfirmButton=1==e.isRead;var a=i.signatureList.slice(-1)[0],s=[i.wqh,i.yqh,i.jj],n=Number(a.signatureStatus);if(i.activeIcon=s[n],i["isOver"]=1==a.signatureStatus,console.log(i.$store.state.userInfo.name),t){var o=i.signatureList.filter((function(e){return e.name==i.$store.state.userInfo.name}));i.isShowBottom=0==o[0].signatureStatus}else{var r=["您已提交申请，请等待审核完成后进行核酸检测","审核已完成","审核已被驳回"];i.applyState=r[n],1==i["isOver"]&&(i.forbidden=!1)}}))},signature:function(e){var t=this,i={token:this.$store.state.localToken,status:e,applicationCode:this.currentUser.appId,comment:this.advices};Object(f["i"])(i).then((function(i){0==i.nextNum&&1==e?t.$router.push({path:"/examine",query:t.currentUser}):t.reload()})),2==e&&this.reload(),sessionStorage.setItem("isLoad",!0)},navToFileList:function(){this.isShowEnclosure=!0,this.titleText="附件",this.isShowBack=!0},confirmOrder:function(){var e=this,t={token:this.currentUser.localToken,applicationCode:this.currentUser.appId,isShowBottom:this.isShowBottom};Object(f["b"])(t).then((function(t){e.isRead=!1}))},clearFile:function(e,t){var i=this;this.fileList.forEach((function(t,a){t.name===e&&i.fileList.splice(a,1)})),this.myuploader.removeFile(t,!0)}}},p=v,g=(i("3767"),Object(u["a"])(p,a,s,!1,null,"9d165b54",null));t["default"]=g.exports},3767:function(e,t,i){"use strict";var a=i("acae"),s=i.n(a);s.a},"458f":function(e,t,i){e.exports=i.p+"img/未签核.37748fe1.svg"},7633:function(e,t,i){},8294:function(e,t,i){"use strict";var a=i("7633"),s=i.n(a);s.a},a434:function(e,t,i){"use strict";var a=i("23e7"),s=i("23cb"),n=i("a691"),o=i("50c4"),r=i("7b0b"),l=i("65f0"),c=i("8418"),u=i("1dde"),d=i("ae40"),m=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,v=Math.min,p=9007199254740991,g="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m||!h},{splice:function(e,t){var i,a,u,d,m,h,w=r(this),S=o(w.length),b=s(e,S),k=arguments.length;if(0===k?i=a=0:1===k?(i=0,a=S-b):(i=k-2,a=v(f(n(t),0),S-b)),S+i-a>p)throw TypeError(g);for(u=l(w,a),d=0;d<a;d++)m=b+d,m in w&&c(u,d,w[m]);if(u.length=a,i<a){for(d=b;d<S-a;d++)m=d+a,h=d+i,m in w?w[h]=w[m]:delete w[h];for(d=S;d>S-a+i;d--)delete w[d-1]}else if(i>a)for(d=S-a;d>b;d--)m=d+a-1,h=d+i-1,m in w?w[h]=w[m]:delete w[h];for(d=0;d<i;d++)w[d+b]=arguments[d+2];return w.length=S-a+i,u}})},acae:function(e,t,i){},b0c0:function(e,t,i){var a=i("83ab"),s=i("9bf2").f,n=Function.prototype,o=n.toString,r=/^\s*function ([^ (]*)/,l="name";!a||l in n||s(n,l,{configurable:!0,get:function(){try{return o.call(this).match(r)[1]}catch(e){return""}}})},b99b:function(e,t,i){e.exports=i.p+"img/拒绝.69854512.svg"},fb6a:function(e,t,i){"use strict";var a=i("23e7"),s=i("861d"),n=i("e8b5"),o=i("23cb"),r=i("50c4"),l=i("fc6a"),c=i("8418"),u=i("b622"),d=i("1dde"),m=i("ae40"),h=d("slice"),f=m("slice",{ACCESSORS:!0,0:0,1:2}),v=u("species"),p=[].slice,g=Math.max;a({target:"Array",proto:!0,forced:!h||!f},{slice:function(e,t){var i,a,u,d=l(this),m=r(d.length),h=o(e,m),f=o(void 0===t?m:t,m);if(n(d)&&(i=d.constructor,"function"!=typeof i||i!==Array&&!n(i.prototype)?s(i)&&(i=i[v],null===i&&(i=void 0)):i=void 0,i===Array||void 0===i))return p.call(d,h,f);for(a=new(void 0===i?Array:i)(g(f-h,0)),u=0;h<f;h++,u++)h in d&&c(a,u,d[h]);return a.length=u,a}})}}]);
//# sourceMappingURL=chunk-3c1fe874.01f9e630.js.map